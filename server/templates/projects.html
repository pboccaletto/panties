{% extends "base.html" %}
{% block title %}Projects - Panties{% endblock %}

{% block content %}
<div class="columns">
  <div class="column is-8">
    <div class="level mb-5">
      <div class="level-left">
        <div class="level-item">
          <div>
            <h1 class="title is-2">
              <span style="font-size: 2rem;">ðŸ©²</span>
              <span class="ml-2">Projects</span>
            </h1>
            <p class="subtitle is-5">Manage your error tracking projects</p>
          </div>
        </div>
      </div>
    </div>

    {% if projects %}
      <div class="box">
        <table class="table is-fullwidth is-hoverable">
          <thead>
            <tr>
              <th><i class="fas fa-hashtag mr-2"></i>ID</th>
              <th><i class="fas fa-tag mr-2"></i>Name</th>
              <th><i class="fas fa-key mr-2"></i>API Key</th>
              <th><i class="fas fa-calendar mr-2"></i>Created</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
          {% for p in projects %}
            <tr>
              <td class="has-text-weight-bold">{{ p.id }}</td>
              <td>
                <span class="tag is-light is-medium">{{ p.name }}</span>
              </td>
              <td>
                <div class="code-block" style="display: inline-block; padding: 0.5rem;">
                  <code style="font-size: 0.75rem;">{{ p.api_key[:16] }}...</code>
                </div>
              </td>
              <td>
                <span class="icon-text">
                  <span class="icon">
                    <i class="fas fa-clock"></i>
                  </span>
                  <span>{{ p.created_at.strftime('%Y-%m-%d %H:%M') }}</span>
                </span>
              </td>
              <td>
                <div class="buttons">
                  <a class="button is-panties is-small" href="{{ url_for('project_detail', project_id=p.id) }}">
                    <span class="icon">
                      <i class="fas fa-eye"></i>
                    </span>
                    <span>View</span>
                  </a>
                  <form method="post" action="{{ url_for('delete_project', project_id=p.id) }}" style="display: inline;" onsubmit="return confirm('Are you sure you want to delete this project? All associated errors will be deleted too.');">
                    <button class="button is-danger is-small" type="submit">
                      <span class="icon">
                        <i class="fas fa-trash"></i>
                      </span>
                      <span>Delete</span>
                    </button>
                  </form>
                </div>
              </td>
            </tr>
          {% endfor %}
          </tbody>
        </table>
      </div>
    {% else %}
      <div class="notification is-info is-light">
        <p class="is-size-5">
          <i class="fas fa-info-circle mr-2"></i>
          No projects yet. Create your first project to get started!
        </p>
      </div>
    {% endif %}
  </div>

  <div class="column is-4">
    <div class="box" style="position: sticky; top: 20px;">
      <h2 class="title is-4">
        <span style="font-size: 1.5rem;">ðŸ©²</span>
        <span class="ml-2">Create Project</span>
      </h2>
      <p class="subtitle is-6 has-text-grey">Set up a new error tracking project</p>

      <form method="post" action="{{ url_for('list_projects') }}">
        <div class="field">
          <label class="label">
            <i class="fas fa-signature mr-2"></i>
            Project Name
          </label>
          <div class="control has-icons-left">
            <input class="input" type="text" name="name" placeholder="My Awesome Project" required>
            <span class="icon is-small is-left">
              <i class="fas fa-pencil-alt"></i>
            </span>
          </div>
          <p class="help">Choose a descriptive name for your project</p>
        </div>

        <div class="field">
          <label class="label">
            <i class="fas fa-align-left mr-2"></i>
            Description
          </label>
          <div class="control">
            <textarea class="textarea" name="description" placeholder="Optional description of your project..." rows="3"></textarea>
          </div>
        </div>

        <div class="field">
          <div class="control">
            <button class="button is-panties is-fullwidth is-medium" type="submit">
              <span class="icon">
                <i class="fas fa-plus"></i>
              </span>
              <span>Create Project</span>
            </button>
          </div>
        </div>
      </form>

      <div class="notification is-light mt-4">
        <p class="is-size-7">
          <i class="fas fa-lightbulb mr-2"></i>
          <strong>Tip:</strong> After creating a project, you'll receive an API key to use in your application.
        </p>
      </div>
    </div>
  </div>
</div>
{% endblock %}
